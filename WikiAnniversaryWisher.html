<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Wiki Anniversary wisher - Multi User</title>
    
    <link rel="icon" type="image/png" href="https://upload.wikimedia.org/wikipedia/commons/6/6b/Draw_this_birthday_cake_.svg">

    <meta name="description" content="A tool to check and send wishes to multiple users' Wiki anniversaries, contributions, and wish them well." />
    <meta name="keywords" content="Wiki, MediaWiki, anniversary, user, contributions, birthday, bulk, multi-user" />
    <meta name="author" content="Suyash Dwivedi" />
    <link rel="canonical" href="https://suyashdwivedi.github.io/Wiki_Tools/WikiAnniversaryWisher.html" />

    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://suyashdwivedi.github.io/Wiki_Tools/WikiAnniversaryWisher.html" />
    <meta property="og:title" content="Wiki Anniversary - Multi User" />
    <meta property="og:description" content="A tool to check multiple users' Wiki anniversaries, contributions, and wish them well." />
    <meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Wikidata_birthday_celebration_visual_-_group_and_cake.png/960px-Wikidata_birthday_celebration_visual_-_group_and_cake.png" />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://suyashdwivedi.github.io/Wiki_Tools/WikiAnniversaryWisher.html" />
    <meta property="twitter:title" content="Wiki Anniversary - Multi User" />
    <meta property="twitter:description" content="A tool to check multiple users' Wiki anniversaries, contributions, and wish them well." />
    <meta property="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Wikidata_birthday_celebration_visual_-_group_and_cake.png/960px-Wikidata_birthday_celebration_visual_-_group_and_cake.png" />
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background-color: #f8f9fa; color: #343a40; text-align: center; overflow-x: hidden; }
        header { background-color: #007bff; color: white; padding: 1em; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; flex-direction: column; }
        header h1, header h3 { margin: 0; }
        header img { height: 75px; margin-right: 15px; }
        #inspiration { margin-top: 10px; font-style: italic; color: #fff; padding-bottom: 10px; max-width: 800px; margin-left: auto; margin-right: auto;}
        main { max-width: 1000px; margin: 20px auto; background-color: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); animation: fadeIn 0.5s ease-in-out; }
        form { display: flex; flex-direction: column; align-items: center; max-width: 600px; margin: 0 auto 20px; }
        label { margin-bottom: 10px; color: #007bff; font-weight: bold; }
        input { padding: 10px; margin-bottom: 20px; width: 100%; box-sizing: border-box; border: 1px solid #ced4da; border-radius: 5px; font-size: 1rem; }
        button { background-color: #007bff; color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 5px; transition: 0.3s ease; font-size: 1rem; }
        button:hover { background-color: #0056b3; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 8px; border: 1px solid #ddd; text-align: center; }
        th { background-color: #007bff; color: white; cursor: pointer; user-select: none; }
        th:hover { background-color: #0056b3; }
        th .sort-indicator { margin-left: 5px; opacity: 0.7; }
        th.sort-asc .sort-indicator { opacity: 1; }
        th.sort-desc .sort-indicator { opacity: 1; }
        .night-mode-button { position: absolute; top: 10px; right: 10px; background-color: #007bff; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; }
        .night-mode { background-color: #121212; color: #f8f9fa; }
        .night-mode header { background-color: #1f1f1f; }
        .night-mode #inspiration { color: #ccc; }
        .night-mode main { background-color: #2c2c2c; color: #f8f9fa; }
        .night-mode label { color: #8ab4f8; }
        .night-mode input { background-color: #3e3e3e; color: #f8f9fa; border: 1px solid #555; }
        .night-mode button { background-color: #8ab4f8; color: black; }
        .night-mode th { background-color: #8ab4f8; color: black; }
        footer { margin-top: 20px; padding: 10px; font-size: 0.9em; color: #6c757d; }
        .copied-message {
            color: green;
            font-weight: bold;
            margin-left: 10px;
            animation: fadeOut 2s forwards;
            display: inline-block;
        }
        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body onload="loadNightModePreference()">

<button class="night-mode-button" onclick="toggleNightMode()">Night Mode</button>

<header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Wiki_s_Lazy_Coders_logo_small_transparent.png" alt="Wiki's Lazy Coders Logo" style="height: 75px; float: left; margin-right: 15px;">
    <div>
        <h1>Wish Wiki Anniversary</h1>
        <h3>(Multi-user mode, according to SUL)</h3>
    </div>
    <p id="inspiration">
        I am amazed and inspired by how Wikimedians dedicate their volunteer time to strengthen and sustain this open-source movement. This is my small effort to acknowledge their contributions, bring a smile to their faces, and make them feel truly appreciated.
 - <a href="https://meta.wikimedia.org/wiki/User:Suyash.dwivedi" target="_blank" style="color: inherit; text-decoration: underline;">Suyash Dwivedi</a>
    </p>
</header>

<main>
    <form id="userForm" onsubmit="event.preventDefault(); getUserDetails();">
        <label for="username">Enter up to 100 Usernames (comma separated):</label>
        <input type="text" id="username" placeholder="User1, User2, User3" required />
        <button type="submit">Get User Details</button>
    </form>
    
    <div id="userDetails"></div>
    <div id="copiedConfirmation" class="copied-message" style="display:none;">Message copied to clipboard!</div>
</main>

<footer>
    Created by <a href="https://meta.wikimedia.org/wiki/User:Suyash.dwivedi" target="_blank">Suyash Dwivedi</a> | Updated on: 02 November 2025
</footer>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-GC8PGC89NB"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-GC8PGC89NB');
</script>
<script src="https://cdn.counter.dev/script.js"
	data-id="cc7a036d-a904-4d76-bcac-37ea4196c014"
	data-utcoffset="6">
</script>

<script>
    let lastSortedColumn = -1;
    let lastSortAsc = true;

    // Function to check if a year is a leap year
    function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0);
    }

    // Function to get anniversary date for a given year, handling leap years
    function getAnniversaryForYear(regDate, targetYear) {
        let anniversary = new Date(regDate);
        anniversary.setFullYear(targetYear);
        anniversary.setHours(0, 0, 0, 0);
        
        // Handle leap day (Feb 29) for non-leap years
        if (regDate.getMonth() === 1 && regDate.getDate() === 29) {
            if (!isLeapYear(targetYear)) {
                // Celebrate on Feb 28 in non-leap years
                anniversary.setDate(28);
            }
        }
        
        return anniversary;
    }

    function loadNightModePreference() {
        if (localStorage.getItem('nightMode') === 'enabled') {
            document.body.classList.add('night-mode');
        }
    }

    function toggleNightMode() {
        document.body.classList.toggle('night-mode');
        const isNightMode = document.body.classList.contains('night-mode');
        if (isNightMode) {
            localStorage.setItem('nightMode', 'enabled');
        } else {
            localStorage.setItem('nightMode', 'disabled');
        }
    }
    
    loadNightModePreference(); 

    function showCopiedMessage() {
        const msg = document.getElementById('copiedConfirmation');
        msg.style.display = 'inline-block';
        setTimeout(() => { msg.style.display = 'none'; }, 3000);
    }

    function calculateAnniversaryData(registrationDate) {
        if (!registrationDate) return {};
        
        const regDate = new Date(registrationDate);
        const today = new Date();
        
        // Reset time part to midnight for accurate date comparison
        today.setHours(0, 0, 0, 0);
        regDate.setHours(0, 0, 0, 0);

        // Get anniversary date for current year
        let anniversaryThisYear = getAnniversaryForYear(regDate, today.getFullYear());
        
        let yearsCompleted;
        let daysToNext;
        let daysSinceLast;
        let isToday = (today.getTime() === anniversaryThisYear.getTime());

        if (today >= anniversaryThisYear) {
            // Anniversary date has passed this year or is today
            
            if (regDate.getFullYear() === today.getFullYear()) {
                // User registered this year - no anniversary yet (need at least 1 year)
                yearsCompleted = 0;
                daysSinceLast = Math.floor((today - regDate) / (1000 * 60 * 60 * 24));
                
                // Next anniversary is next year
                let nextAnniversary = getAnniversaryForYear(regDate, today.getFullYear() + 1);
                daysToNext = Math.ceil((nextAnniversary - today) / (1000 * 60 * 60 * 24));
            } else {
                // User registered in a previous year
                yearsCompleted = today.getFullYear() - regDate.getFullYear();
                
                // Calculate days since last anniversary (this year's anniversary)
                daysSinceLast = Math.floor((today - anniversaryThisYear) / (1000 * 60 * 60 * 24));
                
                // Next anniversary is next year
                let nextAnniversary = getAnniversaryForYear(regDate, today.getFullYear() + 1);
                daysToNext = Math.ceil((nextAnniversary - today) / (1000 * 60 * 60 * 24));
            }
            
        } else {
            // Anniversary hasn't occurred yet this year
            yearsCompleted = today.getFullYear() - regDate.getFullYear() - 1;
            
            // Anniversary is coming up this year
            daysToNext = Math.ceil((anniversaryThisYear - today) / (1000 * 60 * 60 * 24));
            daysSinceLast = 0;
        }

        return { daysToNext, yearsCompleted, isToday, daysSinceLast };
    }

    function isAnniversaryEligible(registration) {
        const { isToday, daysToNext, daysSinceLast, yearsCompleted } = calculateAnniversaryData(registration);
        
        // Must have completed at least 1 year to be eligible for anniversary wishes
        if (yearsCompleted < 1) return false;
        
        // Eligible if: today is anniversary, or within 10 days before, or within 30 days after
        return isToday || (daysToNext > 0 && daysToNext <= 10) || (daysSinceLast > 0 && daysSinceLast <= 30);
    }

    function getHomeWikiUrl(user) {
        if (!user.merged || !user.home) return "Not available";
        const match = user.merged.find(e => e.wiki === user.home);
        return match ? match.url.replace(/\/$/, '') : "Not available";
    }

    async function fetchMultipleUsers(usernames) {
        const container = document.getElementById('userDetails');
        container.innerHTML = `<p>Loading data for ${usernames.length} users...</p>`;
        const promises = usernames.map(async (username) => {
            const encodedUsername = encodeURIComponent(username);
            const url = `https://www.mediawiki.org/w/api.php?action=query&format=json&meta=globaluserinfo&utf8=1&formatversion=2&guiuser=${encodedUsername}&guiprop=editcount|rights|merged|groups|unattached&origin=*`;
            try {
                const res = await fetch(url);
                const data = await res.json();
                if (data.query && data.query.globaluserinfo && data.query.globaluserinfo.missing) {
                     return { name: username, error: true, message: "User does not exist globally" };
                }
                return data.query.globaluserinfo || { name: username, error: true, message: "API data missing" };
            } catch (e) {
                console.error(`Error fetching data for ${username}:`, e);
                return { name: username, error: true, message: "Network or API call failed" };
            }
        });

        const results = await Promise.all(promises);
        displayUsersInTable(results);
    }

    function displayUsersInTable(users) {
        const container = document.getElementById('userDetails');
        container.innerHTML = '';

        const eligibleUsers = users.filter(user => !user.error && isAnniversaryEligible(user.registration));
        const ineligibleUsers = users.filter(user => !user.error && !isAnniversaryEligible(user.registration));
        const errorUsers = users.filter(user => user.error);

        const sortedUsers = [...eligibleUsers, ...ineligibleUsers, ...errorUsers];

        if (sortedUsers.length === 0) {
            container.innerHTML = '<p>No user data found. Please check the usernames and try again.</p>';
            return;
        }

        const table = document.createElement('table');

        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');
        const headers = ['S.No.', 'Username', 'Registration Date', 'Total Edit Count', 'Home Wiki', 'ID', 'Anniversary Status', 'Add Reminder', 'Wish Anniversary'];
        
        headers.forEach((text, idx) => {
            const th = document.createElement('th');
            th.innerHTML = text;
            
            if (idx >= 1 && idx <= 6) { 
                 th.innerHTML += '<span class="sort-indicator">â†•</span>';
                 th.onclick = () => sortTable(table, idx); 
            }
            headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        table.appendChild(thead);

        const tbody = document.createElement('tbody');

        let serialNumber = 1;

        sortedUsers.forEach(user => {
            const row = document.createElement('tr');

            if (user.error) {
                const td = document.createElement('td');
                td.colSpan = headers.length;
                td.style.color = "red";
                td.textContent = `User not found or API error: ${user.name}`;
                row.appendChild(td);
                tbody.appendChild(row);
                return;
            }

            const serialCell = document.createElement('td');
            serialCell.textContent = serialNumber++;
            serialCell.setAttribute('data-sort', serialNumber - 1); 
            row.appendChild(serialCell);

            const { daysToNext, yearsCompleted, isToday, daysSinceLast } = calculateAnniversaryData(user.registration);
            const anniversaryScore = isToday ? 3 : (daysToNext > 0 && daysToNext <= 10) ? 2 : (daysSinceLast > 0 && daysSinceLast <= 30) ? 1 : 0;

            // Username linked
            const usernameCell = document.createElement('td');
            usernameCell.setAttribute('data-sort', user.name.toLowerCase());
            const homeUrl = getHomeWikiUrl(user);
            const userPageUrl = (user.home && homeUrl !== 'Not available')
                ? `${homeUrl}/wiki/User:${encodeURIComponent(user.name.replace(/ /g, '_'))}`
                : `https://www.mediawiki.org/wiki/User:${encodeURIComponent(user.name.replace(/ /g, '_'))}`;
            
            const userLink = document.createElement('a');
            userLink.href = userPageUrl;
            userLink.target = '_blank';
            userLink.textContent = user.name;
            usernameCell.appendChild(userLink);
            row.appendChild(usernameCell);

            // Registration Date
            const regDateCell = document.createElement('td');
            const registrationDate = user.registration ? new Date(user.registration) : null;
            regDateCell.setAttribute('data-sort', registrationDate ? registrationDate.getTime() : 0);
            regDateCell.textContent = registrationDate
                ? `${String(registrationDate.getDate()).padStart(2, '0')}/${registrationDate.toLocaleDateString('en-US', { month: 'long' })}/${registrationDate.getFullYear()}`
                : 'N/A';
            row.appendChild(regDateCell);

            // Total Edit Count
            const editCountCell = document.createElement('td');
            const editCount = user.editcount ?? 'N/A';
            editCountCell.setAttribute('data-sort', user.editcount ?? 0);
            editCountCell.textContent = editCount !== 'N/A' ? editCount.toLocaleString('en-US') : 'N/A';
            row.appendChild(editCountCell);

            // Home Wiki Link
            const homeWikiCell = document.createElement('td');
            homeWikiCell.setAttribute('data-sort', user.home ? user.home.toLowerCase() : 'zzzz');
            if (homeUrl !== "Not available") {
                const homeLink = document.createElement('a');
                homeLink.href = homeUrl;
                homeLink.target = '_blank';
                homeLink.textContent = user.home;
                homeWikiCell.appendChild(homeLink);
            } else {
                homeWikiCell.textContent = 'Not available';
            }
            row.appendChild(homeWikiCell);

            // ID
            const idCell = document.createElement('td');
            idCell.setAttribute('data-sort', user.id ?? 0);
            idCell.textContent = user.id ?? 'N/A';
            row.appendChild(idCell);

            // Anniversary Status
            const statusCell = document.createElement('td');
            let statusText = '-';
            let statusColor = '#6c757d'; 
            
            if (yearsCompleted < 1) {
                // Not yet eligible for anniversary
                statusText = `Registered recently (${daysToNext} days to first anniversary)`;
                statusColor = '#6c757d';
            } else if (isToday) {
                statusText = `TODAY! (${yearsCompleted} years)`;
                statusColor = 'green';
            } else if (daysToNext > 0 && daysToNext <= 10) {
                statusText = `Upcoming in ${daysToNext} days (${yearsCompleted + 1} years)`;
                statusColor = 'orange';
            } else if (daysSinceLast > 0 && daysSinceLast <= 30) {
                statusText = `Belated (${daysSinceLast} days ago - ${yearsCompleted} years)`;
                statusColor = 'red';
            } else {
                statusText = `In ${daysToNext} days (${yearsCompleted + 1} years)`;
                statusColor = '#6c757d';
            }
            
            statusCell.textContent = statusText;
            statusCell.style.color = statusColor;
            statusCell.setAttribute('data-sort', anniversaryScore); 
            row.appendChild(statusCell);

            // Add Reminder button
            const reminderCell = document.createElement('td');
            const reminderBtn = document.createElement('button');
            reminderBtn.textContent = "ðŸ—“ï¸ Save to Calendar";
            reminderBtn.onclick = () => addToCalendar(user);
            reminderBtn.style.padding = '5px 10px';
            reminderCell.appendChild(reminderBtn);
            row.appendChild(reminderCell);

            // Wish Anniversary button
            const wishCell = document.createElement('td');
            if (isAnniversaryEligible(user.registration)) {
                const wishBtn = document.createElement('button');
                wishBtn.textContent = "ðŸŽ‰ Copy & Open Talk";
                wishBtn.onclick = () => wishAnniversary(user);
                wishBtn.style.padding = '5px 10px';
                wishCell.appendChild(wishBtn);
            } else {
                wishCell.textContent = '-';
            }
            row.appendChild(wishCell);

            tbody.appendChild(row);
        });

        table.appendChild(tbody);
        container.appendChild(table);

        if (lastSortedColumn !== -1) {
             const th = table.querySelector(`thead th:nth-child(${lastSortedColumn + 1})`);
             if (th) {
                th.classList.add(lastSortAsc ? 'sort-asc' : 'sort-desc');
                th.querySelector('.sort-indicator').textContent = lastSortAsc ? 'â–²' : 'â–¼';
             }
        }
    }

    function sortTable(table, colIndex) {
        const tbody = table.tBodies[0];
        const rowsArray = Array.from(tbody.rows).filter(row => row.cells.length > 1); 
        
        let asc = (colIndex === lastSortedColumn) ? !lastSortAsc : true;

        table.querySelectorAll('th').forEach(th => {
            th.classList.remove('sort-asc', 'sort-desc');
            const indicator = th.querySelector('.sort-indicator');
            if(indicator) indicator.textContent = 'â†•';
        });

        const currentTh = table.querySelector(`thead th:nth-child(${colIndex + 1})`);
        if (currentTh) {
            currentTh.classList.add(asc ? 'sort-asc' : 'sort-desc');
            currentTh.querySelector('.sort-indicator').textContent = asc ? 'â–²' : 'â–¼';
        }
        
        lastSortedColumn = colIndex;
        lastSortAsc = asc;

        rowsArray.sort((a, b) => {
            let aVal, bVal;
            const aCell = a.cells[colIndex];
            const bCell = b.cells[colIndex];

            if (colIndex === 0 || colIndex === 2 || colIndex === 3 || colIndex === 5 || colIndex === 6) {
                aVal = Number(aCell.getAttribute('data-sort')) || 0;
                bVal = Number(bCell.getAttribute('data-sort')) || 0;
            } else { 
                aVal = aCell.textContent.trim().toLowerCase();
                bVal = bCell.textContent.trim().toLowerCase();
            }

            if (aVal > bVal) return asc ? 1 : -1;
            if (aVal < bVal) return asc ? -1 : 1;
            return 0;
        });

        while(tbody.firstChild) {
            tbody.removeChild(tbody.firstChild);
        }
        rowsArray.forEach(row => tbody.appendChild(row)); 
    }

    function addToCalendar(user) {
        if (!user || !user.registration) return;
        
        const regDate = new Date(user.registration);
        const today = new Date();
        
        // Get next anniversary
        let nextAnniversary = getAnniversaryForYear(regDate, today.getFullYear());
        
        if (today > nextAnniversary) {
            nextAnniversary = getAnniversaryForYear(regDate, today.getFullYear() + 1);
        }

        const nextYear = nextAnniversary.getFullYear();
        const nextMonth = String(nextAnniversary.getMonth() + 1).padStart(2, '0');
        const nextDay = String(nextAnniversary.getDate()).padStart(2, '0');
        const formattedDate = `${nextYear}${nextMonth}${nextDay}`; 
        
        const eventTitle = `Wiki Anniversary of ${user.name}`;
        
       // Format dates as dd/Month/yyyy
        const currentDate = `${String(today.getDate()).padStart(2, '0')}/${today.toLocaleDateString('en-US', { month: 'long' })}/${today.getFullYear()}`;
        const joinDate = `${String(regDate.getDate()).padStart(2, '0')}/${regDate.toLocaleDateString('en-US', { month: 'long' })}/${regDate.getFullYear()}`;
        
        const eventDetails = `Wiki anniversary of ${user.name}, joined on ${joinDate}, till ${currentDate} total edits calculated: ${user.editcount?.toLocaleString() || 'N/A'}. Click here https://suyashdwivedi.github.io/Wiki_Tools/Wiki_Anniversary.html to wish anniversary.`;
        
        const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&dates=${formattedDate}/${formattedDate}&details=${encodeURIComponent(eventDetails)}&sf=true&output=xml`;
        window.open(calendarUrl, '_blank');
    }
    async function wishAnniversary(user) {
        if (!user || !user.name || !user.registration) return;

        const message = generateAnniversaryMessage(user);
        if (!message) {
            alert("This user is not eligible for wishing right now.");
            return;
        }
        
        try {
            await navigator.clipboard.writeText(message);
            showCopiedMessage();
        } catch (err) {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy message to clipboard. Please copy manually.');
        }

        const homeWikiUrl = getHomeWikiUrl(user);
        const wikiBaseUrl = (user.home && homeWikiUrl !== 'Not available') ? homeWikiUrl : `https://www.mediawiki.org`;

        const userTalkPageUrl = `${wikiBaseUrl}/w/index.php?title=User_talk:${encodeURIComponent(user.name.replace(/ /g, '_'))}&action=edit&summary=Wiki Anniversary Wishes`;
        window.open(userTalkPageUrl, '_blank');
    }

    function generateAnniversaryMessage(user) {
        if (!user.registration) return "";

        const { daysToNext, yearsCompleted, isToday, daysSinceLast } = calculateAnniversaryData(user.registration);
        
        // Don't generate message if less than 1 year completed
        if (yearsCompleted < 1) return "";
        
        const edits = user.editcount || 0;
        const totalEditsFormatted = edits.toLocaleString();

        const imageWikitext = `[[File:Rose and Carnation Flower Bouquet 02.png|150px|right|Happy Wiki Anniversary]]`;
        const toolLine = `''Use this [https://suyashdwivedi.github.io/Wiki_Tools/Wiki_Anniversary.html '''Tool'''] to send wiki anniversary wishes to other amazing Wikimedians.''`;

        const openDiv = `<div style="border: 3px solid #f75920; background: #f8f9fa; padding: 15px; margin: 10px 0; font-size: 95%; line-height: 1.6em;">`;
        const closeDiv = `</div>`;

        let innerMessage = "";

        if (isToday) {
            innerMessage = `\r\n== Happy Wiki Anniversary ðŸŽ‰ ==\r\n\r\n${openDiv}
${imageWikitext}

Dear [[User:${user.name}|${user.name}]],

Wishing you a very happy wiki anniversary today, celebrating '''${yearsCompleted} years''' (as per SUL) of invaluable contributions! Your dedication and hard work, reflected in over '''${totalEditsFormatted}''' edits, are a testament to your commitment to the community. Thank you for all you do!

${toolLine}

-- ~~~~
${closeDiv}`;
        } else if (daysToNext > 0 && daysToNext <= 10) {
            innerMessage = `\r\n== Early Wiki Anniversary Wishes ðŸŽ‰ ==\r\n\r\n${openDiv}
${imageWikitext}

Dear [[User:${user.name}|${user.name}]],

Your wiki anniversary is just around the corner, in '''${daysToNext} days!''' What a wonderful milestone of '''${yearsCompleted + 1} years''' on Wiki (as per SUL). Your incredible contributions, with over '''${totalEditsFormatted}''' edits, have truly made a difference. Here's to another amazing year of collaboration and knowledge sharing!

${toolLine}

-- ~~~~
${closeDiv}`;
        } else if (daysSinceLast > 0 && daysSinceLast <= 30) {
            const daysBelated = daysSinceLast;
            innerMessage = `\r\n== Belated Wiki Anniversary Wishes ðŸŽ‰ ==\r\n\r\n${openDiv}
${imageWikitext}

Dear [[User:${user.name}|${user.name}]],

Your wiki anniversary was '''${daysBelated} days''' ago, marking '''${yearsCompleted} years''' (as per SUL) of dedicated service! I wanted to extend a heartfelt thanks for your amazing contributions. With over '''${totalEditsFormatted}''' edits, your dedication is an inspiration to the community. Wishing you all the best for the year ahead!

${toolLine}

-- ~~~~
${closeDiv}`;
        }

        return innerMessage;
    }

    function getUserDetails() {
        const input = document.getElementById('username').value.trim();
        if (!input) return;
        let usernames = input.split(',').map(u => u.trim()).filter(u => u);
        if (usernames.length === 0) return;

        if (usernames.length > 100) {
            alert("Maximum 100 usernames allowed at once. Only the first 100 will be processed.");
            usernames = usernames.slice(0, 100);
        }
        fetchMultipleUsers(usernames);
    }
</script>

</body>
</html>
